#:import la kivy.adapters.listadapter

<RotImage>:
    angle: 0
    orientation: 1
    canvas.before:
        PushMatrix
        Rotate:
            angle:root.angle
            axis: 0, 0, 1
            origin: root.center
    canvas.after:
        PopMatrix

<Direntry@ButtonBehavior+FloatLayout>:
    text: 'default'
    source: None
    orientation: 1
    on_release: app.on_direntry_selected(self.text) or True
    RotImage:
        x: root.x
        y: root.y
        source: root.source
        orientation: root.orientation
    Label:
        pos_hint: {'center_x': 0.5, 'y': 0}
        text_size: (240, None)
        text: root.text
        size: self.texture_size
        size_hint: (None, None)
    Label:
        pos_hint: {'center_x': 0.5, 'top': 1}
        text_size: (240, None)
        text: str(root.orientation)
        size: self.texture_size
        size_hint: (None, None)

[DirentryListRow@BoxLayout]:
    size_hint_y: None
    height: 240
    Direntry:
        text: ctx.dir1
        source: ctx.thumb1
        orientation: ctx.orientation1
    Direntry:
        text: ctx.dir2
        source: ctx.thumb2
        orientation: ctx.orientation2

ListView:
    id: lv
    adapter:
        la.ListAdapter(
        data = [],
        args_converter = lambda row_index, rec: {'dir1': rec[0]['direntry'], 'dir2': rec[1]['direntry'], 'thumb1': rec[0]['thumb_url'], 'thumb2': rec[1]['thumb_url'], 'orientation1': rec[0]['orientation'], 'orientation2': rec[1]['orientation']},
        template='DirentryListRow',
        selection_mode = 'none'
        )